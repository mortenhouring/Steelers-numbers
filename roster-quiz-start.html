<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Roster Quiz Start</title>
<style>
  body { font-family: sans-serif; text-align: center; padding: 2rem; }
  #status { margin-bottom: 1rem; font-size: 1.2rem; }
  #remaining { margin-bottom: 2rem; font-size: 1rem; color: #555; }
  button { font-size: 1rem; padding: 0.5rem 1rem; margin: 0.5rem; cursor: pointer; }
</style>
</head>
<body>

<div id="status"></div>
<div id="remaining"></div>
<div id="buttons"></div>

<script>
  const STORAGE_KEYS = {
    CURRENT_ROSTER: 'roster-currentRoster',
    TOTAL_QUESTIONS: 'roster-totalQuestions',
    LAST_PLAYER: 'roster-lastPlayer',
    LAST_ANSWER: 'roster-lastAnswer',
    QUESTIONS_ASKED: 'roster-questionsAsked',
    SCORE: 'roster-score'
  };

  const statusEl = document.getElementById('status');
  const remainingEl = document.getElementById('remaining');
  const buttonsEl = document.getElementById('buttons');

  function safeParseJSON(raw) {
    try { return JSON.parse(raw); } catch { return null; }
  }

  // Check if a game is in progress
  const currentRoster = safeParseJSON(localStorage.getItem(STORAGE_KEYS.CURRENT_ROSTER));
  const score = parseInt(localStorage.getItem(STORAGE_KEYS.SCORE), 10) || 0;
  const totalQuestions = parseInt(localStorage.getItem(STORAGE_KEYS.TOTAL_QUESTIONS), 10) || 0;
  const inProgress = Array.isArray(currentRoster) && currentRoster.length > 0;

  if (inProgress) {
    const remaining = currentRoster.length;
    statusEl.textContent = `Game in progress â€” Score: ${score}/${totalQuestions}`;
    remainingEl.textContent = `Remaining questions: ${remaining}`;

    const continueBtn = document.createElement('button');
    continueBtn.textContent = 'Continue game';
    continueBtn.onclick = () => window.location.href = 'roster-quiz.html';
    buttonsEl.appendChild(continueBtn);

    const startOverBtn = document.createElement('button');
    startOverBtn.textContent = 'Start over';
    startOverBtn.onclick = () => {
      Object.values(STORAGE_KEYS).forEach(key => localStorage.removeItem(key));
      window.location.href = 'roster-quiz.html';
    };
    buttonsEl.appendChild(startOverBtn);

  } else {
    statusEl.textContent = `No game in progress`;
    remainingEl.textContent = '';

    const startBtn = document.createElement('button');
    startBtn.textContent = 'Start game';
    startBtn.onclick = () => {
      Object.values(STORAGE_KEYS).forEach(key => localStorage.removeItem(key));
      window.location.href = 'roster-quiz.html';
    };
    buttonsEl.appendChild(startBtn);
  }
</script>

</body>
</html>